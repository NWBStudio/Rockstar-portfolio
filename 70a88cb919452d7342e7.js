(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{380:function(e,t,i){},393:function(e,t,i){"use strict";var r=i(380);i.n(r).a},406:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("form",{staticClass:"review-form edit-form",on:{submit:function(t){return t.preventDefault(),e.sendForm(t)}}},[i("div",{staticClass:"review-form__header edit-form-header"},["add"===e.formType?i("h3",{staticClass:"edit-form-title"},[e._v("Новый отзыв")]):e._e(),"edit"===e.formType?i("h3",{staticClass:"edit-form-title"},[e._v("Изменить отзыв")]):e._e()]),i("div",{staticClass:"reviwes-form__add-img"},[i("label",{staticClass:"review-form__file-input-label",class:{"review-form__file-input-label--droppable":e.droppable},on:{drop:function(t){return t.preventDefault(),e.handleFileDrop(t)},dragover:function(t){t.preventDefault(),e.droppable=!0},dragleave:function(t){t.preventDefault(),e.droppable=!1}}},[i("div",{staticClass:"review-form__img-containter",class:{"review-form__img-containter--filled":e.renderedPhoto.length},style:{backgroundImage:"url("+e.renderedPhoto+")"}}),i("input",{ref:"fileInput",staticClass:"review-form__file-input",attrs:{type:"file"},on:{change:e.handleFileInput}}),i("div",{staticClass:"review-form__file-input-btn text-btn-or-link"},[e._v("Добавить фото")])])]),i("div",{staticClass:"review-form__fields"},[i("div",{staticClass:"review-form__row"},[i("label",{staticClass:"form-label reviews__form-label"},[i("div",{staticClass:"form-label__title"},[e._v("Имя автора ")]),"add"===e.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:e.review.author,expression:"review.author"}],staticClass:"admin-input form-label__input",attrs:{type:"text",required:"",name:"name"},domProps:{value:e.review.author},on:{input:function(t){t.target.composing||e.$set(e.review,"author",t.target.value)}}}):e._e(),"edit"===e.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:e.editedReview.author,expression:"editedReview.author"}],staticClass:"admin-input form-label__input",attrs:{type:"text",required:"",name:"name"},domProps:{value:e.editedReview.author},on:{input:function(t){t.target.composing||e.$set(e.editedReview,"author",t.target.value)}}}):e._e()]),i("label",{staticClass:"form-label reviews__form-label"},[i("div",{staticClass:"form-label__title"},[e._v("Титул автора")]),"add"===e.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:e.review.occ,expression:"review.occ"}],staticClass:"admin-input form-label__input",attrs:{required:"",name:"occ"},domProps:{value:e.review.occ},on:{input:function(t){t.target.composing||e.$set(e.review,"occ",t.target.value)}}}):e._e(),"edit"===e.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:e.editedReview.occ,expression:"editedReview.occ"}],staticClass:"admin-input form-label__input",attrs:{required:"",name:"occ"},domProps:{value:e.editedReview.occ},on:{input:function(t){t.target.composing||e.$set(e.editedReview,"occ",t.target.value)}}}):e._e()])]),i("div",{staticClass:"review-form__row"},[i("label",{staticClass:"form-label"},[i("div",{staticClass:"form-label__title"},[e._v("Отзыв")]),"add"===e.formType?i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.review.text,expression:"review.text"}],staticClass:"admin-textarea form-label__input",attrs:{type:"text",required:""},domProps:{value:e.review.text},on:{input:function(t){t.target.composing||e.$set(e.review,"text",t.target.value)}}}):e._e(),"edit"===e.formType?i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editedReview.text,expression:"editedReview.text"}],staticClass:"admin-textarea form-label__input",attrs:{type:"text",required:""},domProps:{value:e.editedReview.text},on:{input:function(t){t.target.composing||e.$set(e.editedReview,"text",t.target.value)}}}):e._e()])]),i("div",{staticClass:"review-form__controls form-controls"},[i("button",{staticClass:"text-btn-or-link",attrs:{type:"button",disabled:e.isSending},on:{click:function(t){return e.$emit("hideForm")}}},[e._v("Отмена")]),i("button",{staticClass:"filled-btn",attrs:{type:"submit",disabled:e.isSending}},[e._v("Загрузить")])])])])};r._withStripped=!0;var n=i(140);function a(e,t,i,r,n,a,o){try{var s=e[a](o),d=s.value}catch(e){return void i(e)}s.done?t(d):Promise.resolve(d).then(r,n)}function o(e){return function(){var t=this,i=arguments;return new Promise(function(r,n){var o=e.apply(t,i);function s(e){a(o,r,n,s,d,"next",e)}function d(e){a(o,r,n,s,d,"throw",e)}s(void 0)})}}function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var d={props:{formType:{type:String,default:"add",required:!0},editedReview:{type:Object,default:function(){},required:!0}},data:function(){return{renderedPhoto:"",review:{photo:"",author:"",occ:"",text:""},isSending:!1,droppable:!1,errorText:""}},watch:{formType:{handler:function(){"edit"===this.formType?this.renderedPhoto="https://webdev-api.loftschool.com/".concat(this.editedReview.photo):this.clearInputs()},immediate:!0}},mounted:function(){this.clearFileInput()},updated:function(){"edit"===this.formType&&(this.renderedPhoto="https://webdev-api.loftschool.com/".concat(this.editedReview.photo),this.clearFileInput())},methods:function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),r.forEach(function(t){s(e,t,i[t])})}return e}({},Object(n.b)("reviews",["addReview","editReview"]),{clearInputs:function(){var e=this;this.renderedPhoto="",Object.keys(this.review).forEach(function(t){e.review[t]=""}),Object.keys(this.editedReview).forEach(function(t){e.editedReview[t]=""})},clearFileInput:function(){this.$refs.fileInput.value=""},addNewReview:function(){var e=o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.isSending=!0,e.next=4,this.addReview(this.review);case 4:this.$emit("hideForm"),this.clearInputs(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.$emit("errorEvent",e.t0);case 11:return e.prev=11,this.isSending=!1,e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(){return e.apply(this,arguments)}}(),editExistedReview:function(){var e=o(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.isSending=!0,e.next=4,this.editReview(this.editedReview);case 4:this.$emit("hideForm"),this.clearInputs(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.$emit("errorEvent",e.t0);case 11:return e.prev=11,this.isSending=!1,e.finish(11);case 14:case"end":return e.stop()}},e,this,[[0,8,11,14]])}));return function(){return e.apply(this,arguments)}}(),sendForm:function(){"add"===this.formType&&this.addNewReview(),"edit"===this.formType&&this.editExistedReview()},handleFileDrop:function(e){if(this.droppable=!1,1===e.dataTransfer.files.length){var t=e.dataTransfer.files[0];this.fileValidation(t)}else alert("Можно загрузить только один файл")},handleFileInput:function(e){var t=e.target.files[0];this.fileValidation(t)},fileValidation:function(e){"image/jpeg"===e.type||"image/png"===e.type?e.size/1048576<1.5?this.handleFile(e):alert("Нельзя загружать файлы размером больше 1.5Mb"):alert("Принимаются только изображения в форматах jpg и png")},handleFile:function(e){"add"===this.formType&&(this.review.photo=e),"edit"===this.formType&&(this.editedReview.photo=e),this.renderImageFile(e)},renderImageFile:function(e){var t=this,i=new FileReader;try{i.readAsDataURL(e),i.onloadend=function(){t.renderedPhoto=i.result}}catch(e){this.$emit("errorEvent","Ошибка при чтении файла")}}})},l=(i(393),i(94)),c=Object(l.a)(d,r,[],!1,null,"4bc59c8e",null);c.options.__file="src/admin/components/review-form.vue";t.default=c.exports}}]);