(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{378:function(t,e,i){},391:function(t,e,i){"use strict";var r=i(378);i.n(r).a},404:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{staticClass:"work-form edit-form",on:{submit:function(e){return e.preventDefault(),t.sendForm(e)}}},[i("div",{staticClass:"work-form__header edit-form-header"},["add"===t.formType?i("h3",{staticClass:"edit-form-title"},[t._v("Добавление работы ")]):t._e(),"edit"===t.formType?i("h3",{staticClass:"edit-form-title"},[t._v("Изменение работы")]):t._e()]),i("div",{staticClass:"work-form__img-container",class:{"work-form__img-container--droppable":t.droppable,"work-form__img-container--filled":t.renderedPhoto.length},style:{backgroundImage:"url("+t.renderedPhoto+")"},on:{drop:function(e){return e.preventDefault(),t.handleFileDrop(e)},dragover:function(e){e.preventDefault(),t.droppable=!0},dragleave:function(e){e.preventDefault(),t.droppable=!1}}},[i("div",{staticClass:"work-form__img-tutorial"},[t._v("Перетащите либо загрузите изображения")]),i("label",{staticClass:"work-form__file-input-label"},[i("div",{staticClass:"work-form__img-btn filled-btn"},[t._v("Загрузить"),i("input",{ref:"fileInput",staticClass:"work-form__file-input",attrs:{type:"file"},on:{change:t.handleFileInput}})]),i("div",{staticClass:"work-form__change-file-btn text-btn-or-link"},[t._v("Изменить превью")])])]),i("div",{staticClass:"work-form__fields"},[i("label",{staticClass:"form-label"},[i("div",{staticClass:"form-label__title"},[t._v("Название ")]),"add"===t.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:t.work.title,expression:"work.title"}],staticClass:"admin-input form-label__input",attrs:{type:"text",required:"",name:"name"},domProps:{value:t.work.title},on:{input:function(e){e.target.composing||t.$set(t.work,"title",e.target.value)}}}):t._e(),"edit"===t.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:t.editedWork.title,expression:"editedWork.title"}],staticClass:"admin-input form-label__input",attrs:{type:"text",required:"",name:"name"},domProps:{value:t.editedWork.title},on:{input:function(e){e.target.composing||t.$set(t.editedWork,"title",e.target.value)}}}):t._e()]),i("label",{staticClass:"form-label"},[i("div",{staticClass:"form-label__title"},[t._v("Ссылка")]),"add"===t.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:t.work.link,expression:"work.link"}],staticClass:"admin-input form-label__input",attrs:{type:"text",required:""},domProps:{value:t.work.link},on:{input:function(e){e.target.composing||t.$set(t.work,"link",e.target.value)}}}):t._e(),"edit"===t.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:t.editedWork.link,expression:"editedWork.link"}],staticClass:"admin-input form-label__input",attrs:{type:"text",required:""},domProps:{value:t.editedWork.link},on:{input:function(e){e.target.composing||t.$set(t.editedWork,"link",e.target.value)}}}):t._e()]),i("label",{staticClass:"form-label"},[i("div",{staticClass:"form-label__title"},[t._v("Описание")]),"add"===t.formType?i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.work.description,expression:"work.description"}],staticClass:"admin-textarea form-label__input",attrs:{type:"text",required:""},domProps:{value:t.work.description},on:{input:function(e){e.target.composing||t.$set(t.work,"description",e.target.value)}}}):t._e(),"edit"===t.formType?i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editedWork.description,expression:"editedWork.description"}],staticClass:"admin-textarea form-label__input",attrs:{type:"text",required:""},domProps:{value:t.editedWork.description},on:{input:function(e){e.target.composing||t.$set(t.editedWork,"description",e.target.value)}}}):t._e()]),i("label",{staticClass:"form-label work-form__tags-input"},[i("div",{staticClass:"form-label__title"},[t._v("Добавление тега")]),"add"===t.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:t.work.techs,expression:"work.techs"}],staticClass:"admin-input form-label__input",attrs:{type:"text",required:""},domProps:{value:t.work.techs},on:{input:function(e){e.target.composing||t.$set(t.work,"techs",e.target.value)}}}):t._e(),"edit"===t.formType?i("input",{directives:[{name:"model",rawName:"v-model",value:t.editedWork.techs,expression:"editedWork.techs"}],staticClass:"admin-input form-label__input",attrs:{type:"text",required:""},domProps:{value:t.editedWork.techs},on:{input:function(e){e.target.composing||t.$set(t.editedWork,"techs",e.target.value)}}}):t._e()]),i("ul",{staticClass:"tags"},t._l(t.tags,function(e,r){return i("li",{staticClass:"tags__item work-tag"},[t._v(t._s(e)),i("button",{staticClass:"work-form__remove-tag-btn",attrs:{type:"button"},on:{click:function(e){return t.removeTag(r)}}})])}),0),i("div",{staticClass:"work-form__controls form-controls"},[i("button",{staticClass:"text-btn-or-link",attrs:{type:"button"},on:{click:function(e){return t.$emit("hideForm")}}},[t._v("Отмена")]),i("button",{staticClass:"filled-btn",attrs:{type:"submit"}},[t._v("Загрузить")])])])])};r._withStripped=!0;var o=i(140);function n(t,e,i,r,o,n,a){try{var s=t[n](a),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(r,o)}function a(t){return function(){var e=this,i=arguments;return new Promise(function(r,o){var a=t.apply(e,i);function s(t){n(a,r,o,s,l,"next",t)}function l(t){n(a,r,o,s,l,"throw",t)}s(void 0)})}}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var l={props:{formType:{type:String,default:"add",required:!0},editedWork:{type:Object,default:function(){},required:!0}},data:function(){return{renderedPhoto:"",work:{title:"",techs:"",photo:"",link:"",description:""},isSending:!1,droppable:!1}},computed:{tags:{get:function(){var t;return"add"===this.formType&&this.work.techs.length&&(t=this.work.techs.split(", ")),"edit"===this.formType&&(t=this.editedWork.techs.split(", ")),t},set:function(t){"add"===this.formType&&this.work.techs.length&&(this.work.techs=t.join(", ")),"edit"===this.formType&&(this.editedWork.techs=t.join(", "))}}},watch:{formType:{handler:function(){"edit"===this.formType?this.renderedPhoto="https://webdev-api.loftschool.com/".concat(this.editedWork.photo):this.clearInputs()},immediate:!0}},mounted:function(){this.clearFileInput()},updated:function(){"edit"===this.formType&&(this.renderedPhoto="https://webdev-api.loftschool.com/".concat(this.editedWork.photo),this.clearFileInput())},methods:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?Object(arguments[e]):{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),r.forEach(function(e){s(t,e,i[e])})}return t}({},Object(o.b)("works",["addWork","editWork"]),{clearInputs:function(){var t=this;this.renderedPhoto="",Object.keys(this.work).forEach(function(e){t.work[e]=""}),Object.keys(this.editedWork).forEach(function(e){t.editedWork[e]=""})},clearFileInput:function(){this.$refs.fileInput.value=""},addNewWork:function(){var t=a(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.isSending=!0,t.next=4,this.addWork(this.work);case 4:this.$emit("hideForm"),this.clearInputs(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.$emit("errorEvent",t.t0);case 11:return t.prev=11,this.isSending=!1,t.finish(11);case 14:case"end":return t.stop()}},t,this,[[0,8,11,14]])}));return function(){return t.apply(this,arguments)}}(),editExistedWork:function(){var t=a(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.isSending=!0,t.next=4,this.editWork(this.editedWork);case 4:this.$emit("hideForm"),this.clearInputs(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.$emit("errorEvent",t.t0);case 11:return t.prev=11,this.isSending=!1,t.finish(11);case 14:case"end":return t.stop()}},t,this,[[0,8,11,14]])}));return function(){return t.apply(this,arguments)}}(),removeTag:function(t){this.tags=this.tags.filter(function(e,i){return i!==t})},sendForm:function(){"add"===this.formType&&this.addNewWork(),"edit"===this.formType&&this.editExistedWork()},handleFileDrop:function(t){if(this.droppable=!1,1===t.dataTransfer.files.length){var e=t.dataTransfer.files[0];this.fileValidation(e)}else alert("Можно загрузить только один файл")},handleFileInput:function(t){var e=t.target.files[0];this.fileValidation(e)},fileValidation:function(t){"image/jpeg"===t.type||"image/png"===t.type?t.size/1048576<1.5?this.handleFile(t):alert("Нельзя загружать файлы размером больше 1.5Mb"):alert("Принимаются только изображения в форматах jpg и png")},handleFile:function(t){this.work.photo=t,"add"===this.formType&&(this.work.photo=t),"edit"===this.formType&&(this.editedWork.photo=t),this.renderImageFile(t)},renderImageFile:function(t){var e=this,i=new FileReader;try{i.readAsDataURL(t),i.onloadend=function(){e.renderedPhoto=i.result}}catch(t){this.$emit("errorEvent","Ошибка при чтении файла")}}})},d=(i(391),i(94)),c=Object(d.a)(l,r,[],!1,null,"c94877c0",null);c.options.__file="src/admin/components/work-form.vue";e.default=c.exports}}]);